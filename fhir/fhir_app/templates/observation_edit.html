{%load static%}
{% include 'material/includes/material_css.html' %}
{% include 'material/includes/material_js.html' %}
{% load material_form %}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Observation</title>
    <link rel="stylesheet" href="{% static 'fhir_app/css/observation_edit.css' %}">
</head>

<body>
    <div class="observation" id="observation">
        <div class="observation-data">
            
                <p>Version id: {{observation.meta.versionId}}</p>
                <p>Last updated: {{observation.meta.lastUpdated}}</p>
                <p>Id: {{observation.id}}</p>
                <form action="." method="get" id="observation-edit">
                <label for="value">Value:</label>
                    
                        {%if observation.valueQuantity.value is not None%}
                            <input value={{observation.valueQuantity.value}} name="value" id="value"></input>
                        {% elif observation.valueCodeableConcept is not None%}
                            <input value={{observation.valueCodeableConcept.text}} name="value" id="value"></input>
                        {%else%}
                            <input value={{observation.component.0.valueQuantity.value}} name="value" id="value"></input>
                        {%endif%}
                        
                        
                    
                
                        
                <p>Category: {{observation.category.0.coding.0.display}}</p>
                <p>Code: {{observation.code.coding.0.display}}</p>
                <label for="status">Status:</label>
                        <input value={{observation.status}} name="status", id="status">
                        </input>
                
                </form>
                {%if observation.valueQuantity.unit is not None%}
                <p>Unit: {{observation.valueQuantity.unit|cut:"{"|cut:"}"}}</p>
                {% elif observation.component.0.valueQuantity.unit is not None%}
                <p>Unit: {{observation.component.0.valueQuantity.unit|cut:"{"|cut:"}"}}</p>
                {% else %}
                {%endif%}
                <div class="buttons">
                <button type="submit" class="btn update-button" form="observation-edit">
                    <span class="mdc-button__label">UPDATE</span>
                </button>
                <a href={% url "observation_history" observation.id observation.meta.versionId%}>
                    <button class="btn history-button">
                        <span class="mdc-button__label">HISTORY</span>
                    </button>
                </a>
                <a href={% url "patient" observation.subject.reference|cut:"Patient/" %}>
                    <button class="btn return-button">
                        <span class="mdc-button__label">RETURN</span>
                    </button>
                </a>
                </div>
        </div>
    </div>
</body>

</html>